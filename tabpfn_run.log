============================================================
TabPFN Cherry Blossom Peak Bloom Prediction
============================================================
Loaded 15300 total records from 9 files
Locations: 332
Year range: 812-2025

Toronto records: 14
Other locations: 15286

============================================================
BENCHMARK 1: General Performance (80/20 split)
============================================================

============================================================
Benchmarking TabPFN on Combined Dataset (80/20 split)
============================================================
Training samples: 12228
Test samples: 3058
Note: Sampling 10,000 training samples (TabPFN limit)
Using 10000 training samples

Training TabPFN...
Making predictions...

Combined Dataset (80/20 split) Results:
  MAE:  4.80 days
  RMSE: 6.54 days
  R²:   0.8849

Sample predictions (first 10):
Actual     Predicted    Error     
-----------------------------------
106        104.7        1.3       
92         92.0         -0.0      
132        117.9        14.1      
94         99.9         -5.9      
97         94.0         3.0       
104        108.0        -4.0      
118        127.5        -9.5      
105        116.1        -11.1     
116        106.7        9.3       
107        106.4        0.6       

============================================================
TORONTO IMPUTATION: Predicting Toronto bloom dates
============================================================

Training on 15286 samples from other locations...
Note: Using ignore_pretraining_limits=True to leverage all 15286 samples
Predicting Toronto bloom dates for 14 years...

============================================================
TORONTO PREDICTION RESULTS
============================================================
MAE:  24.91 days
RMSE: 26.41 days
R²:   -8.4630

Year   Actual DOY   Predicted DOY   Error (days)    Bloom Date     
---------------------------------------------------------------------------
2012   104          101.9           2.1             2012-04-13     
2013   123          101.4           21.6            2013-05-03     
2014   136          101.0           35.0            2014-05-16     
2015   127          100.3           26.7            2015-05-07     
2016   130          99.7            30.3            2016-05-09     
2017   118          99.2            18.8            2017-04-28     
2018   129          98.7            30.3            2018-05-09     
2019   133          98.1            34.9            2019-05-13     
2020   127          97.6            29.4            2020-05-06     
2021   114          97.0            17.0            2021-04-24     
2022   128          96.3            31.7            2022-05-08     
2023   114          95.5            18.5            2023-04-24     
2024   115          94.7            20.3            2024-04-24     
2025   126          94.0            32.0            2025-05-06     

============================================================
FOCUS: Toronto 2020-2025 Predictions
============================================================
MAE (2020-2025):  24.83 days
RMSE (2020-2025): 25.63 days

Year   Actual DOY   Predicted DOY   Error (days)   
-------------------------------------------------------
2020   127          97.6            29.4           
2021   114          97.0            17.0           
2022   128          96.3            31.7           
2023   114          95.5            18.5           
2024   115          94.7            20.3           
2025   126          94.0            32.0           

✓ Saved Toronto predictions to: toronto_predictions.csv

============================================================
SUMMARY
============================================================
General Benchmark (other locations): MAE = 4.80 days
Toronto Imputation (all years):      MAE = 24.91 days
Toronto 2020-2025:                    MAE = 24.83 days

✓ Analysis complete!
